<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../styles/css/style.css">  
  <title>Index</title>
  <script src="../scripts/before/dark-sky-api.js"></script>
</head>

<body>
    <div class="wrapsite">

      <header class="template">
        <div class="big-word-box">
          <span class="big-letter">C</span>
          <span class="big-letter">Z</span>
          <span class="big-letter">E</span>
          <span class="big-letter">C</span>
          <span class="big-letter">H</span>
          <span class="big-letter">I</span>
          <span class="big-letter">A</span>
      </div>  
   
    <img src="../img/bkg/czech-republic-flag640-vertical.png" class="down-flag down-arrow">
    </header> 
    
    <nav class="menu" id="navbox">
      <a class="flag-link" href="#"><img src="../img/bkg/czech-republic-flag640.png" class="flag-menu"></a>
        <div class="dropdownBackground">
          <span class="arrow"></span>
        </div>

        <ul class="submenu-box" id="menu-list">
          <li>
            <a href="">Geography</a>
            <div class="dropdown">
              <h4>Metropolises</h4>
              <a href="#">Prague</a>
              <a href="#">Brno</a>
              <a href="#">Link 3</a>
          <a href="#">Link 4</a>
            </div>
          </li>
          <li>
            <a href="">History</a>
            <div class="dropdown">
              <h4>Metropolises</h4>
              <a href="#">Prague</a>
              <a href="#">Brno</a>
              <a href="#">Link 3</a>
          <a href="#">Link 4</a>
            </div>
          </li>
          <li>
            <a href="">Citys</a>
            <div class="dropdown">
              <h4>Metropolises</h4>
              <a href="#">Prague</a>
              <a href="#">Brno</a>
              <a href="#">Link 3</a>
          <a href="#">Link 4</a>
            </div>
          </li>
          <li>
            <a href="">Nature</a>
            <div class="dropdown">
              <h4>Metropolises</h4>
              <a href="#">Prague</a>
              <a href="#">Brno</a>
              <a href="#">Link 3</a>
          <a href="#">Link 4</a>
            </div>
          </li>
          <li>
            <a href="">Government</a>
            <div class="dropdown">
              <h4>Metropolises</h4>
              <a href="#">Prague</a>
              <a href="#">Brno</a>
              <a href="#">Link 3</a>
          <a href="#">Link 4</a>
            </div>
          </li>
        </ul>
        <div class="scroll-indicator"></div>
      </nav>  
      
<div class="info-plugins">
      
      <div class="weather-box">
      <img id="current-icon">
      <div id="current-weather-details">
           <a class="weather-link" id="current-humidity">--</a>
           <a class="weather-link" id="current-pressure">--</a>
           <a class="weather-link" id="current-uvIndex">--</a>
           <img id="temperature-icon">
           <a class="weather-link" id="current-temperature">--</a>
           <a class="weather-link" id="current-wind-bearing">--</a>
           <a class="weather-link" id="current-wind-speed">--</a>  
           </div>
               <button id="getWeather" onclick="getWeather()">Get Current Weather!</button>      
      <p id="weather-summary" class="weather-sum"></p>
 </div>
      
 <div class="weatherWidget">
  <div id="loading">Click for local weather</div>
  <div class="place">
    <span class="city"></span><span class="country"></span>
  </div>
  <div class="temp"></div>
  <div class="desc"></div>
</div>

<div class="currency">
 <!--Currency Converter widget by FreeCurrencyRates.com -->
<div id='gcw_mainF2iGzWPq4' class='gcw_mainF2iGzWPq4' style="background-color: var(--blue); color: #c9e0f8;"></div>
<a id='gcw_siteF2iGzWPq4' href='https://freecurrencyrates.com/en/' style="background-color: var(--blue); color:#c9e0f8;">FreeCurrencyRates.com</a>
</div>
</div> 
<div class="simple-calendar"></div>
  <h3>Geography</h3>

  <figure>
    <img class="contentimg align-right slide-in"  id="pic" src="../img/cont/zlin-TGM-statue.jpg" alt="">
    <figcaption>TGM statue</figcaption>
  </figure>

   <p class="hidden">The Czech Republic (/ˈtʃɛk rɪˈpʌblɪk/ (About this sound listen)[10] Czech: Česká republika, Czech pronunciation: [ˈtʃɛskaː ˈrɛpuˌblɪka] (About this sound listen)),[11] also known as Czechia[12] (/ˈtʃɛkiə/ (About this sound listen); Czech: Česko, pronounced [ˈtʃɛsko] (About this sound listen)), is a landlocked country in Central Europe bordered by Germany to the west, Austria to the south, Slovakia to the east and Poland to the northeast.[13] The Czech Republic covers an area of 78,866 square kilometres (30,450 sq mi) with a mostly temperate continental climate and oceanic climate. It is a unitary parliamentary republic, has 10.6 million inhabitants and the capital and largest city is Prague, with 1.3 million residents. The Czech Republic is a member of the European Union (EU), NATO, the OECD, the United Nations, the OSCE, and the Council of Europe.</p>
   
  <h3>Stats</h3>   


  <figure>
    <img class="contentimg align-left slide-in"  id="pic" src="../img/cont/buchlov-louky.jpg" alt="">
    <figcaption>Chriby</figcaption>
  </figure>


        <p class="hidden">
    It is a developed country[14] with an advanced,[15] high income[16] export-oriented social market economy based in services, manufacturing and innovation. The UNDP ranks the country 14th in inequality-adjusted human development.[17] The Czech Republic is a welfare state with a "continental" European social model, a universal health care system and tuition-free university education. It ranks as the 6th safest or most peaceful country and is one of the most non-religious countries in the world,[18] while achieving strong performance in democratic governance.</p>
   
  
  <h3>History</h3>

  <figure>
    <img class="contentimg align-right slide-in"  id="pic" src="../img/cont/mahenovo-divadlo-brno.jpg" alt="">
    <figcaption>Mahen Theatre</figcaption>
  </figure>

    <p class="hidden">
    The Czech Republic includes the historical territories of Bohemia,[19] Moravia, and Czech Silesia. The Czech state was formed in the late 9th century as the Duchy of Bohemia under the Great Moravian Empire. After the fall of the Empire in 907, the centre of power transferred from Moravia to Bohemia under the Přemyslid dynasty. In 1002, the duchy was formally recognized as part of the Holy Roman Empire,[20][21] becoming the Kingdom of Bohemia in 1198 and reaching its greatest territorial extent in the 14th century. Besides Bohemia itself, the king of Bohemia ruled the lands of the Bohemian Crown, he had a vote in the election of the Holy Roman Emperor, and Prague was the imperial seat in periods between the 14th and 17th century. In the Hussite wars of the 15th century driven by the Protestant Bohemian Reformation, the kingdom faced economic embargoes and defeated five consecutive crusades proclaimed by the leaders of the Catholic Church.</p>

    <figure>
      <img class="contentimg align-left slide-in"  id="pic" src="../img/cont/church-stare-mesto.jpg" alt="">
      <figcaption>Catholic Church Stare Mesto</figcaption>
    </figure>

    <p class="hidden">
    Following the Battle of Mohács in 1526, the whole Crown of Bohemia was gradually integrated into the Habsburg Monarchy alongside the Archduchy of Austria and the Kingdom of Hungary. The Protestant Bohemian Revolt (1618–20) against the Catholic Habsburgs led to the Thirty Years' War. After the Battle of the White Mountain, the Habsburgs consolidated their rule, eradicated Protestantism and reimposed Catholicism, and also adopted a policy of gradual Germanization. With the dissolution of the Holy Roman Empire in 1806, the Bohemian Kingdom became part of the Austrian Empire and the Czech language experienced a revival as a consequence of widespread romantic nationalism. In the 19th century, the Czech lands became the industrial powerhouse of the monarchy and were subsequently the core of the Republic of Czechoslovakia, which was formed in 1918 following the collapse of the Austro-Hungarian Empire after World War I.</p>

    <figure>
      <img class="contentimg align-right slide-in"  id="pic" src="../img/cont/corner-flag.jpg" alt="">
      <figcaption>Vysehrad</figcaption>
    </figure>
          
    <p class="hidden">
    Czechoslovakia remained the only democracy in this part of Europe in the interwar period.[22] However, the Czech part of Czechoslovakia was occupied by Germany in World War II, while the Slovak region became the Slovak Republic; Czechoslovakia was liberated in 1945 by the armies of the Soviet Union and the United States. The Czech country lost the majority of its German-speaking inhabitants after they were expelled following the war. The Communist Party of Czechoslovakia won the 1946 elections and after the 1948 coup d'état, Czechoslovakia became a one-party communist state under Soviet influence. In 1968, increasing dissatisfaction with the regime culminated in a reform movement known as the Prague Spring, which ended in a Soviet-led invasion. Czechoslovakia remained occupied until the 1989 Velvet Revolution, when the communist regime collapsed and market economy was reintroduced. On 1 January 1993, Czechoslovakia peacefully dissolved, with its constituent states becoming the independent states of the Czech Republic and Slovakia. The Czech Republic joined NATO in 1999 and the EU in 2004.</p>  
  
<div class="css-carrusel">
	<figure class="only-css-slider">
		<figure class="css-slide">
			<img src="../img/cont/123.jpg" alt>
			<figcaption>Hobbiton, New Zealand</figcaption>
		</figure>
		<figure class="css-slide">
			<img src="../img/cont/129.jpg" alt>
			<figcaption>Wanaka, New Zealand</figcaption>
		</figure>
		<figure class="css-slide">
      <img src="../img/cont/132.jpg" alt>
			<figcaption>Utah, United States</figcaption>
		</figure>
		<figure class="css-slide">
			<img src="../img/cont/125.jpg" alt>
			<figcaption>Bryce Canyon, Utah, United States</figcaption>
		</figure>
		<figure class="css-slide">
			<img src="../img/cont/112.jpg" alt>
			<figcaption>Hobbiton, New Zealand</figcaption>
		</figure>
	</figure>
</div>

<footer>
    <div class="search-box">
        <form id="searchItem" onsubmit="return false">
          <input type="search" id="searchInput" name="search" autocomplete="on" placeholder="Enter search term here">
          <button type="button" id="search-button" onclick="getArticle()">&#9755;</button>
          <button type="button" class="search-close"> &#9747;</button>
        </form>
        <div class="search-result"></div>
        <div class="suggestions">
            <ul></ul>
          </div>
      </div>
    <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2058314.3021129183!2d13.57809096500988!3d49.91064209129525!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x470b948fd7dd8243%3A0xf8661c75d3db586f!2sCzechia!5e0!3m2!1sen!2scz!4v1526812826093"></iframe>
    <a href="http://www.checkczechia.cz/"><img src="../img/lgo/mapxflag.png" alt="map"></a>
    <a href="https://www.tripadvisor.com/Tourism-g274684-Czech_Republic-Vacations.html">tripadvisor.com</a>
    
</footer> 

    </div>  

    <div class="loader" id="loaderbox" >
      <div class="loader-inner">
        <div class="loader-line-wrap">
          <div class="loader-line"></div>
        </div>
        <div class="loader-line-wrap">
          <div class="loader-line"></div>
        </div>
        <div class="loader-line-wrap">
          <div class="loader-line"></div>
        </div>
        <div class="loader-line-wrap">
          <div class="loader-line"></div>
        </div>
        <div class="loader-line-wrap">
          <div class="loader-line"></div>
        </div>
      </div>
    </div>    

    <button class="toTop" id="tiptop">&#9650;</button>

        <a class="toggle" href="#example" id="burger">☰</a>
      <div class="toggle-content" id="example">
<ul class="mobile-menu">
<li class="sub-list"> <h4>Geography</h4>
<ul class="sub-mobil-menu">
   <li><a href="">Czech republic1</a></li>
    <li><a href="">Czech republic2</a></li>
    <li><a href="">Czech republic3</a></li>
    <li><a href="">Czech republic4</a></li>
    <li><a href="">Czech republic5</a></li>    
</ul>
</li>  

<li class="sub-list"> <h4>History</h4>
    <ul class="sub-mobil-menu">
       <li><a href="">Czech republic1</a></li>
        <li><a href="">Czech republic2</a></li>
        <li><a href="">Czech republic3</a></li>
        <li><a href="">Czech republic4</a></li>
        <li><a href="">Czech republic5</a></li>    
    </ul>
    </li> 

<li class="sub-list"> <h4>Government</h4>
        <ul class="sub-mobil-menu">
           <li><a href="">Czech republic1</a></li>
            <li><a href="">Czech republic2</a></li>
            <li><a href="">Czech republic3</a></li>
            <li><a href="">Czech republic4</a></li>
            <li><a href="">Czech republic5</a></li>    
        </ul>
        </li> 

<li class="sub-list"> <h4>Travel</h4>
            <ul class="sub-mobil-menu">
               <li><a href="">Czech republic1</a></li>
                <li><a href="">Czech republic2</a></li>
                <li><a href="">Czech republic3</a></li>
                <li><a href="">Czech republic4</a></li>
                <li><a href="">Czech republic5</a></li>    
            </ul>
            </li> 
 
</ul>
      </div>
<script>
  'use strict'

/*scroll indicator*/

function indicateScroll() {
  let scrollIndicator = document.querySelector(".scroll-indicator");
  let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
  let scrolled = (window.pageYOffset / height) * 100;
scrollIndicator.style.width = scrolled + "%";
}

window.addEventListener('scroll', indicateScroll ); 

/*simple 12month calendar*/

const tableBox = document.querySelector('.simple-calendar');

for (var i = 0; i < 12; i++) {
  // create a table for month with thead & tbody
  var table = document.createElement('table');
  var thead = document.createElement('thead');
  var tbody = document.createElement('tbody');
table.classList.add('simple-table');
  // get weeks for a given month
  var calendar = createCalendar(2016, i);

  // iterate weeks
  for (var j = 0; j < calendar.length; j++) {
    // create table row for every week
    var tr = document.createElement('tr');
    var week = calendar[j];

    // iterate days
    for (var k = 0; k < week.length; k++) {
      // create table cell for every day
      var td = document.createElement('td');
      td.classList.add('simple-column');
      var day = week[k];

      // set day of month as table cell text content
      td.textContent = day.date.getDate();

      // add before/after class
      day.before && td.classList.add('before');
      day.after && td.classList.add('after');

      // mount table cell
      tr.appendChild(td);
    }
    // mount table row
    tbody.appendChild(tr);
  }

  // create thead
  thead.innerHTML = '<tr><td class="simple-column">' + 'Su Mo Tu We Th Fr Sa'.split(' ').join('</td><td class="simple-column">') + '</td></tr>';

  // mount thead & tbody
  table.appendChild(thead);
  table.appendChild(tbody);

  // mount table to body
tableBox.appendChild(table);
}

function createCalendar(year, month) {
  var results = [];

  // find out first and last days of the month
  var firstDate = new Date(year, month, 1);
  var lastDate = new Date(year, month + 1, 0)

  // calculate first sunday and last saturday
  var firstSunday = getFirstSunday(firstDate);
  var lastSaturday = getLastSaturday(lastDate);

  // iterate days starting from first sunday
  var iterator = new Date(firstSunday);
  var i = 0;

  // ..until last saturday
  while (iterator <= lastSaturday) {
    if (i++ % 7 === 0) {
      // start new week when sunday
      var week = [];
      results.push(week);
    }

    // push day to week
    week.push({
      date: new Date(iterator),
      before: iterator < firstDate, // add indicator if before current month
      after: iterator > lastDate // add indicator if after current month
    });

    // iterate to next day
    iterator.setDate(iterator.getDate() + 1);
  }

  return results;
}

function getFirstSunday(firstDate) {
  var offset = firstDate.getDay();

  var result = new Date(firstDate);
  result.setDate(firstDate.getDate() - offset);

  return result;
}

function getLastSaturday(lastDate) {
  var offset = 6 - lastDate.getDay();

  var result = new Date(lastDate);
  result.setDate(lastDate.getDate() + offset);

  return result;
}

function zoomCell(e) {
let targetCell =  e.target;
if(targetCell.tagName === "TD" && !(targetCell.parentNode.parentNode.tagName === 'THEAD')) {
targetCell.classList.toggle('scale-cell');
}
}

tableBox.addEventListener('click',zoomCell);

    let startPos;
let lat;
let lon;
let isCelsius = true;
let city;
let country;
let tempKelvin;
let tempF;
let tempC;
let tempDescription;
let icon;
const getApiUrl = (lat, lon) => 'https://api.openweathermap.org/data/2.5/weather?lat=' + lat + '&lon=' + lon + '&appid=b9a27cb7ac119cdefa622ce5fd7c0546';
const getIconUrl = code => `http://openweathermap.org/img/w/${code}.png`;
const geoSuccess = position => {
  startPos = position;
  lat = startPos.coords.latitude;
  lon = startPos.coords.longitude;

  // call the api and fetch the weather
  makeRequest('GET', getApiUrl(lat, lon), handleWeather);
};

const makeRequest = (type, url, callback) => {
  const req = new XMLHttpRequest();
  let response = '';

  req.open(type, url, true);

  req.onreadystatechange = () => {
    if (req.readyState === XMLHttpRequest.DONE && req.status === 200) {
      callback(req.responseText);
    }
  }
  req.send(null);
};

const setNodeContents = (node, content) => {
  document.querySelector(node).innerHTML = content;
}

const setImage = (node, src, altTag) => {
  document.querySelector(node).src = src;
  document.querySelector(node).alt = altTag;
}

const formatTemp = x => Number.parseFloat(x).toFixed(1);

const updateTempDashboard = (city, country, temp, desc, icon) => {
  document.querySelector('#loading').remove();
  setNodeContents('.city', city);
  setNodeContents('.country', `, ${country}`);
  setNodeContents('.temp', `${temp} ºC`);
  setNodeContents('.desc', desc);
  setImage('.icon', icon, desc);
}

const getCelsius = tempKelvin => formatTemp(tempKelvin - 273);

const getFahrenheit = tempKelvin => formatTemp(1.8 * (tempKelvin - 273) + 32);

const handleToggleTemp = () => {

  if(isCelsius) {
    setNodeContents('.temp', tempF + ' ºF');
  } else {
    setNodeContents('.temp', tempC + ' ºC');
  }
  isCelsius = !isCelsius;
}

const handleWeather = (data) => {
  const obj = JSON.parse(data);
  city = obj.name;
  country = obj.sys.country;
  tempKelvin = obj.main.temp;
  tempF = getFahrenheit(tempKelvin);
  tempC = getCelsius(tempKelvin);
  tempDescription = obj.weather[0].main;
  icon = getIconUrl(obj.weather[0].icon);

  document.querySelector('.temp').addEventListener('click', handleToggleTemp);

  updateTempDashboard(city, country, tempC, tempDescription, icon);
  
}

const weatherWidgetbox = document.querySelector('.weatherWidget');

function getPosition() {
     navigator.geolocation.getCurrentPosition(geoSuccess);
}
weatherWidgetbox.addEventListener('click', getPosition)  
  
/*wiki search*/

let result = document.querySelector(".search-result");
let searchItem = document.getElementById("searchItem");
let searchInput = document.getElementById("searchInput");
let closeSearch = document.querySelector('.search-close');

let wikiUrl = "https://en.wikipedia.org/w/api.php?action=query&generator=search&format=json&formatversion=2&utf8=1&origin=*&gsrnamespace=0&gsrlimit=10&prop=extracts&exsentences=1&exlimit=10&explaintext=1&exintro=1&gsrsearch="
let linkUrl = "https://en.wikipedia.org/?curid=";

searchInput.addEventListener("keyup", function(event) {
	event.preventDefault();	
	if (event.keyCode === 13) {
		document.getElementById("search-button").click();
	}
});

function getArticle() {	
	result.innerHTML = "";
	let text = searchItem.elements[0].value;
	//to convert spaces to %20 for multiword search terms
  let searchTerm = text.replace(/\s+/g,'%20');	
	let searchUrl = wikiUrl + searchTerm;
  	
	let article = new XMLHttpRequest();
	article.open('GET', searchUrl);	
	article.onload = function() {
	  let articleData = JSON.parse(article.responseText);
		wikiInfo(articleData);
    };
	article.send();	
}
  
function wikiInfo(data) {	
	for (let i = 0; i < data.query.pages.length; i++) {
		let url = linkUrl + data.query.pages[i].pageid;    
		let wrapper = document.createElement("a");		
		let div = document.createElement("div");    
		div.setAttribute("class", "outputItem");
		wrapper.setAttribute("href", url);
		wrapper.setAttribute("target", "_blank");	
        wrapper.style.textDecoration = 'none';
		let divString = `<div class="result-title"> ${data.query.pages[i].title} </div> <p class="result-text">  ${data.query.pages[i].extract} </p>`;
		div.innerHTML = divString;
    wrapper.appendChild(div);
		result.appendChild(wrapper);
  }
}

function closeSearchResults(e) {
let searchContent = document.querySelectorAll('.outputItem');
searchContent.forEach(item => item.remove());

}

closeSearch.addEventListener('click', closeSearchResults);    

/*autocomplete search*/

const input = document.querySelector('#searchInput');
const suggestions = document.querySelector('.suggestions ul');

const citySugestions = [ 'Prague','Brno','Ostrava','Plzen','Liberec','Olomouc','Usti nad Labem','Hradec Kralove','Ceske Budejovice','Pardubice','Havirov','Zlin','Kladno','Most','Karwina','Frydek-Mistek','Opava','Karlovy Vary','Teplice','Decin','Jihlava','Chomutov','Prerov','Mlada Boleslav'];
function search(str) {
	let results = [];
	const val = str.toLowerCase();

	for (i = 0; i < citySugestions.length; i++) {
		if (citySugestions[i].toLowerCase().indexOf(val) > -1) {
			results.push(citySugestions[i]);
		}
	}

	return results;
}

function searchHandler(e) {
	const inputVal = e.currentTarget.value;
	let results = [];
	if (inputVal.length > 0) {
		results = search(inputVal);
	}
	showSuggestions(results);
}

function showSuggestions(results) {
    
    suggestions.innerHTML = '';

	if (results.length > 0) {
		for (i = 0; i < results.length; i++) {
			suggestions.innerHTML += `<li class="suggestion-item">${results[i]}</li>`;
		}
		suggestions.classList.add('has-suggestions');
	} else {
		results = [];
		suggestions.innerHTML = '';
		suggestions.classList.remove('has-suggestions');
	}
}

function useSuggestion(e) {
	input.value = e.target.innerText;
	input.focus();
	suggestions.innerHTML = '';
	suggestions.classList.remove('has-suggestions');
}

input.addEventListener('keyup', searchHandler);
suggestions.addEventListener('click', useSuggestion);    

</script>
</body>
</html>